<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cartoons @ 420360</title>
  
  <!-- SEO Metadata -->
  <meta name="description" content="Pen and ink cartoon gallery by woodmurderedhat. Hand-drawn sketches and illustrations in retro web style.">
  <meta name="keywords" content="cartoons, pen and ink, drawings, sketches, illustrations, art, 420360, woodmurderedhat">
  <meta name="author" content="woodmurderedhat">
  <meta name="theme-color" content="#4a8c3a">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:title" content="Cartoons @ 420360">
  <meta property="og:description" content="Pen and ink cartoon gallery by woodmurderedhat">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://420360.xyz/cartoons/">
  <meta property="og:site_name" content="420360 Cartoons">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@woodenhat">
  <meta name="twitter:title" content="Cartoons @ 420360">
  <meta name="twitter:description" content="Pen and ink cartoon gallery by woodmurderedhat">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://420360.xyz/cartoons/">
  
  <!-- Pixel font -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../assets/images/favicon.ico">
  
  <!-- Stylesheet -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  
  <!-- Header -->
  <header>
    <div class="header-content">
      <h1>üßÄ CARTOONS @ 420360</h1>
      <p class="subtitle">Pen & Ink Drawings</p>
      <a href="../" class="back-link">‚Üê Back to 420360</a>
    </div>
  </header>

  <!-- Gallery Grid -->
  <main>
    <div id="gallery" class="masonry-grid">
      <!-- Images loaded dynamically from cartoons.json -->
    </div>
    
    <!-- Loading indicator -->
    <div id="loading" class="loading-text">Loading cartoons...</div>
    
    <!-- Empty state -->
    <div id="empty-state" class="empty-state" style="display: none;">
      <p>No cartoons yet. Check back soon! üßÄ</p>
    </div>
  </main>

  <!-- Lightbox Modal -->
  <div id="lightbox" class="lightbox" style="display: none;">
    <div class="lightbox-overlay"></div>
    <div class="lightbox-content">
      <button class="lightbox-close" aria-label="Close lightbox">‚úï</button>
      <button class="lightbox-prev" aria-label="Previous image">‚Äπ</button>
      <button class="lightbox-next" aria-label="Next image">‚Ä∫</button>
      <img id="lightbox-img" src="" alt="">
      <div id="lightbox-title" class="lightbox-title"></div>
      <div class="lightbox-counter">
        <span id="lightbox-current">1</span> / <span id="lightbox-total">1</span>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>Part of the <a href="../" rel="noopener">420360</a> universe</p>
    <p>By <a href="https://github.com/woodmurderedhat" target="_blank" rel="noopener">woodmurderedhat</a></p>
  </footer>

  <!-- Gallery Script -->
  <script>
    // Gallery state
    let cartoons = [];
    let currentIndex = 0;

    // Load cartoons from JSON
    async function loadCartoons() {
      try {
        const response = await fetch('cartoons.json');
        cartoons = await response.json();
        
        if (cartoons.length === 0) {
          document.getElementById('loading').style.display = 'none';
          document.getElementById('empty-state').style.display = 'block';
          return;
        }
        
        renderGallery();
        document.getElementById('loading').style.display = 'none';
      } catch (error) {
        console.error('Error loading cartoons:', error);
        document.getElementById('loading').textContent = 'Error loading cartoons üò¢';
      }
    }

    // Render gallery grid
    function renderGallery() {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = '';
      
      cartoons.forEach((cartoon, index) => {
        const item = document.createElement('div');
        item.className = 'gallery-item';
        
        const img = document.createElement('img');
        img.src = getThumbnailUrl(cartoon.url);
        img.alt = cartoon.title || `Cartoon ${index + 1}`;
        img.loading = 'lazy';
        img.addEventListener('click', () => openLightbox(index));
        
        item.appendChild(img);
        
        if (cartoon.title) {
          const title = document.createElement('div');
          title.className = 'gallery-item-title';
          title.textContent = cartoon.title;
          item.appendChild(title);
        }
        
        gallery.appendChild(item);
      });
    }

    // Convert Google Photos URL to thumbnail size
    function getThumbnailUrl(url) {
      // Replace resolution parameter for thumbnail
      return url.replace(/=w\d+/, '=w800').replace(/=s\d+/, '=w800');
    }

    // Get full-size URL
    function getFullSizeUrl(url) {
      // Use high resolution for lightbox
      return url.replace(/=w\d+/, '=w2400').replace(/=s\d+/, '=s0');
    }

    // Open lightbox
    function openLightbox(index) {
      currentIndex = index;
      const lightbox = document.getElementById('lightbox');
      const img = document.getElementById('lightbox-img');
      const title = document.getElementById('lightbox-title');
      const current = document.getElementById('lightbox-current');
      const total = document.getElementById('lightbox-total');
      
      img.src = getFullSizeUrl(cartoons[index].url);
      img.alt = cartoons[index].title || `Cartoon ${index + 1}`;
      title.textContent = cartoons[index].title || '';
      current.textContent = index + 1;
      total.textContent = cartoons.length;
      
      lightbox.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    // Close lightbox
    function closeLightbox() {
      document.getElementById('lightbox').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    // Navigate lightbox
    function navigateLightbox(direction) {
      currentIndex += direction;
      if (currentIndex < 0) currentIndex = cartoons.length - 1;
      if (currentIndex >= cartoons.length) currentIndex = 0;
      openLightbox(currentIndex);
    }

    // Event listeners
    document.querySelector('.lightbox-close').addEventListener('click', closeLightbox);
    document.querySelector('.lightbox-prev').addEventListener('click', () => navigateLightbox(-1));
    document.querySelector('.lightbox-next').addEventListener('click', () => navigateLightbox(1));
    document.querySelector('.lightbox-overlay').addEventListener('click', closeLightbox);

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      const lightbox = document.getElementById('lightbox');
      if (lightbox.style.display === 'flex') {
        if (e.key === 'Escape') closeLightbox();
        if (e.key === 'ArrowLeft') navigateLightbox(-1);
        if (e.key === 'ArrowRight') navigateLightbox(1);
      }
    });

    // Initialize
    loadCartoons();
  </script>

</body>
</html>
